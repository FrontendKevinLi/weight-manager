"use strict";(self["webpackChunkweight_manager"]=self["webpackChunkweight_manager"]||[]).push([[133],{723:function(t,r,e){e.d(r,{$:function(){return s},S:function(){return c}});var n=e(655),a=e(864),i=e(6257),o=e(1580),u=(0,i.ad)(),s=function(t){return(0,n.mG)(void 0,void 0,Promise,(function(){var r,e,s,c,h;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return[4,(0,a.C)((function(){return(0,o.j3)()}))];case 1:if(r=n.sent(),r.error)throw r.error;if(null==o.I8.currentUser)throw new Error("User not logged in or not exist");return e=t.year.toString(),s=t.month.toString(),c=(0,i.JU)(u,"users",o.I8.currentUser.uid,e,s),[4,(0,i.QT)(c)];case 2:return h=n.sent(),h.exists()?[2,h.data()]:[2,{}]}}))}))},c=function(t,r){return(0,n.mG)(void 0,void 0,void 0,(function(){var e,s,c,h,l,d;return(0,n.Jh)(this,(function(n){switch(n.label){case 0:return[4,(0,a.C)((function(){return(0,o.j3)()}))];case 1:if(e=n.sent(),e.error)throw e.error;if(null==o.I8.currentUser)throw new Error("User not logged in or not exist");return s=t.year.toString(),c=t.month.toString(),h=t.day.toString(),l=(0,i.JU)(u,"users",o.I8.currentUser.uid,s,c),[4,(0,a.C)((function(){var t;return(0,i.pl)(l,(t={},t[h]=r,t),{merge:!0})}))];case 2:if(d=n.sent(),d.error)throw d.error;return[2]}}))}))}},5571:function(t,r,e){e.r(r),e.d(r,{default:function(){return L}});var n=e(6252),a={class:"dashboard-view"},i={class:"weighing-item-wrapper"};function o(t,r,e,o,u,s){var c=(0,n.up)("WeighingItem"),h=(0,n.up)("LastDaysWeightBarChart");return(0,n.wg)(),(0,n.iD)("div",a,[(0,n._)("div",i,[t.showWeighingItem?((0,n.wg)(),(0,n.j4)(c,{key:0})):(0,n.kq)("",!0)]),(0,n.Wm)(h,{onInited:t.handleBarChartInited,onNotEnoughData:t.handleBarChartNotEnoughData},null,8,["onInited","onNotEnoughData"])])}var u=e(655),s=e(3577),c=e(2262),h=e(8023),l=e(8319),d=e(9344),f=e(8690),v=e(2739),g=e(7740),w=e(8492),m=e(120),p=e(723),b=e(864),y=e(3002),C=e(990),D=e(3783),_=e.p+"img/arrow-right-solid.ab3f199d.svg",I=e(4952),x=e.n(I),E={class:"labeled-icon-button"},S={class:"label"},N=(0,n.aZ)({__name:"LabeledIconButton",props:{label:null,svgSrc:null},setup:function(t){var r=t;return function(t,e){return(0,n.wg)(),(0,n.iD)("div",E,[(0,n._)("span",S,(0,s.zw)(r.label),1),(0,n.Wm)((0,c.SU)(x()),{src:r.svgSrc},null,8,["src"])])}}}),R=e(3744);const k=(0,R.Z)(N,[["__scopeId","data-v-6172d952"]]);var M=k,W={class:"last-days-weight-bar-chart-wrapper"},A=(0,n.aZ)({__name:"LastDaysWeightBarChart",emits:["inited","not-enough-data"],setup:function(t,r){var e=this,a=r.emit;(0,h.D)([f.N,v.N,g.N,d.N,w.N]);var i=m.ou.now().day<=7,o="Complete weekly records to show charts!",I="Record now",x=(0,c.iH)([]),E=(0,c.iH)(),S=(0,c.iH)(),N=(0,c.qj)({currentMonthRecord:{},lastMonthRecord:{}}),R=(0,c.iH)(!1),k=(0,n.Fl)((function(){return x.value.length>=8})),A=function(){return(0,u.mG)(e,void 0,void 0,(function(){var t,r,e;return(0,u.Jh)(this,(function(n){switch(n.label){case 0:return t=m.ou.now(),[4,(0,b.C)((function(){return(0,p.$)(t)}))];case 1:return r=n.sent(),r.error?(e=(0,y.pm)(),e.error(r.error.message),[2]):(N.currentMonthRecord=r.data,[2])}}))}))},U=function(){return(0,u.mG)(e,void 0,void 0,(function(){var t,r,e;return(0,u.Jh)(this,(function(n){switch(n.label){case 0:return t=m.ou.now().minus({month:1}),[4,(0,b.C)((function(){return(0,p.$)(t)}))];case 1:return r=n.sent(),r.error?(e=(0,y.pm)(),e.error(r.error.message),[2]):(N.lastMonthRecord=r.data,[2])}}))}))};function B(){return(0,u.mG)(this,void 0,void 0,(function(){return(0,u.Jh)(this,(function(t){switch(t.label){case 0:return[4,A()];case 1:return t.sent(),i?[4,U()]:[3,3];case 2:t.sent(),t.label=3;case 3:return R.value=!0,[2]}}))}))}function G(t){var r,e,n,a,i=t.hasSame(m.ou.now(),"month");return i?null!==(e=null===(r=N.currentMonthRecord[t.day])||void 0===r?void 0:r.weight)&&void 0!==e?e:0:null!==(a=null===(n=N.lastMonthRecord[t.day])||void 0===n?void 0:n.weight)&&void 0!==a?a:0}function J(){for(var t=[],r=7;r>-1;r-=1){var e=m.ou.now().minus({day:r}),n=G(e);if(0===n)break;var a={date:e.toISODate(),weight:n};t.push(a)}return t}function Z(t){var r=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;return t.forEach((function(t){r=Math.min(r,t.weight),e=Math.max(e,t.weight)})),[r,e]}function L(t,r,e){return t===r?"#9cc7ea":t===e?"#314782":"#4f85c7"}function O(t,r,e){var n={seriesData:[],xAxisData:[]};return t.forEach((function(t){n.xAxisData.push(t.date),n.seriesData.push({value:t.weight,itemStyle:{color:L(t.weight,r,e)}})})),n}var T=function(t){window.addEventListener("resize",(function(){t.resize()}))};function j(t){if(!t.value)throw a("inited"),new Error("Chart init failed. DOM element does not exits.");var r=(0,l.S1)(t.value);return T(r),a("inited"),r}var z=function(t,r){var e=Z(r),n=e[0],a=e[1],i=O(r,n,a);t.setOption({title:{show:!0,text:"Last Days",left:"0",textStyle:{color:"#2d4e69"}},tooltip:{},xAxis:{type:"category",data:i.xAxisData,axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",show:!1,scale:!0,min:n-1},series:[{data:i.seriesData,itemStyle:{borderRadius:10},type:"bar"}],grid:{left:"0",right:"0"},animationEasing:"exponentialInOut"})},H=function(){if(null!=E.value){var t=C.ZP.timeline();t.fromTo(E.value,{autoAlpha:0,scale:.75},{autoAlpha:1,scale:1,ease:"expo.easeInOut",duration:.5})}},F=function(){D.Z.push({name:"records"})};return(0,n.bv)((function(){return(0,u.mG)(e,void 0,void 0,(function(){var t;return(0,u.Jh)(this,(function(r){switch(r.label){case 0:return[4,B()];case 1:return r.sent(),x.value=J(),k.value?(t=j(S),z(t,x.value),[2]):(H(),a("not-enough-data"),[2])}}))}))})),function(t,r){return(0,n.wg)(),(0,n.iD)("div",W,[(0,n._)("div",{ref_key:"barChartRef",ref:S,class:"bar-chart"},null,512),(0,n._)("div",{ref_key:"hintWrapperRef",ref:E,class:"hint-wrapper"},[(0,n._)("span",{class:"hint"},(0,s.zw)(o)),(0,n.Wm)(M,{"svg-src":(0,c.SU)(_),label:I,onClick:F,onKeydown:F},null,8,["svg-src"])],512)])}}});const U=(0,R.Z)(A,[["__scopeId","data-v-5c3c2aea"]]);var B=U,G=(0,n.RC)({loader:function(){return Promise.all([e.e(522),e.e(570)]).then(e.bind(e,1453))}}),J=(0,n.aZ)({name:"DashboardView",components:{WeighingItem:G,LastDaysWeightBarChart:B},data:function(){return{barChart:{inited:!1,notEnoughData:!1}}},computed:{showWeighingItem:function(){var t=this.barChart.inited||this.barChart.notEnoughData;return t}},methods:{handleBarChartInited:function(){this.barChart.inited=!0},handleBarChartNotEnoughData:function(){this.barChart.notEnoughData=!0}}});const Z=(0,R.Z)(J,[["render",o],["__scopeId","data-v-36ca72a7"]]);var L=Z}}]);
//# sourceMappingURL=133.467bab7b.js.map