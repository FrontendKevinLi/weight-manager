"use strict";(self["webpackChunkweight_manager"]=self["webpackChunkweight_manager"]||[]).push([[458],{723:function(e,n,t){t.d(n,{$:function(){return s},S:function(){return c}});var r=t(655),a=t(864),i=t(6257),o=t(1580),u=(0,i.ad)(),s=function(e){return(0,r.mG)(void 0,void 0,Promise,(function(){var n,t,s,c,l;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return[4,(0,a.C)((function(){return(0,o.j3)()}))];case 1:if(n=r.sent(),n.error)throw n.error;if(null==o.I8.currentUser)throw new Error("User not logged in or not exist");return t=e.year.toString(),s=e.month.toString(),c=(0,i.JU)(u,"users",o.I8.currentUser.uid,t,s),[4,(0,i.QT)(c)];case 2:return l=r.sent(),l.exists()?[2,l.data()]:[2,{}]}}))}))},c=function(e,n){return(0,r.mG)(void 0,void 0,void 0,(function(){var t,s,c,l,d,v;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return[4,(0,a.C)((function(){return(0,o.j3)()}))];case 1:if(t=r.sent(),t.error)throw t.error;if(null==o.I8.currentUser)throw new Error("User not logged in or not exist");return s=e.year.toString(),c=e.month.toString(),l=e.day.toString(),d=(0,i.JU)(u,"users",o.I8.currentUser.uid,s,c),[4,(0,a.C)((function(){var e;return(0,i.pl)(d,(e={},e[l]=n,e),{merge:!0})}))];case 2:if(v=r.sent(),v.error)throw v.error;return[2]}}))}))}},3815:function(e,n,t){t.r(n),t.d(n,{default:function(){return ee}});var r=t(6252),a=t(655),i=t(2262),o=t(3577),u=t(9963),s=t(723),c=t(9553),l=t(864),d=t(990),v=t(5317),f=t(120),h=t(3002),m=t(4952),w=t.n(m),g=t.p+"img/chevron-left-solid.1a0326cf.svg",p=t.p+"img/chevron-right-solid.0e609023.svg",y=t.p+"img/plus-solid.49f524bb.svg",T={class:"calendar-controls"},_={class:"arrow-icon"},S={class:"calendar-date"},k={class:"year"},I={class:"month"},b={class:"arrow-icon"},C={class:"records-controls"},U={class:"add-icon"},M=(0,r.aZ)({__name:"CalendarHeader",props:{dateTime:null},emits:["previous-month","next-month","add"],setup:function(e,n){var t=this,u=n.emit,s=e,l=(0,c.Z)(),f=(0,r.Fl)((function(){return l.isMobile})),h=(0,i.iH)(),m=(0,r.Fl)((function(){return s.dateTime.year})),M=(0,r.Fl)((function(){return f.value?s.dateTime.monthShort:s.dateTime.monthLong})),J=function(){if(null!=h.value){var e=d.ZP.timeline();e.fromTo(h.value,{autoAlpha:0,width:0},{autoAlpha:1,width:"auto",duration:1,ease:v.Au.easeInOut})}},G=function(){return(0,a.mG)(t,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){return u("previous-month"),[2]}))}))},Z=function(){return(0,a.mG)(t,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){return u("next-month"),[2]}))}))},D=function(){u("add")};return(0,r.bv)((function(){J()})),function(e,n){return(0,r.wg)(),(0,r.iD)("div",{ref_key:"calendarHeaderRef",ref:h,class:"calendar-header"},[(0,r._)("div",T,[(0,r._)("div",_,[(0,r.Wm)((0,i.SU)(w()),{src:(0,i.SU)(g),onKeydown:G,onClick:G},null,8,["src"])]),(0,r._)("div",S,[(0,r._)("span",k,(0,o.zw)((0,i.SU)(m)),1),(0,r._)("span",I,(0,o.zw)((0,i.SU)(M)),1)]),(0,r._)("div",b,[(0,r.Wm)((0,i.SU)(w()),{src:(0,i.SU)(p),onClick:Z,onKeydown:Z},null,8,["src"])])]),(0,r._)("div",C,[(0,r._)("div",U,[(0,r.Wm)((0,i.SU)(w()),{src:(0,i.SU)(y),onClick:D},null,8,["src"])])])],512)}}}),J=t(3744);const G=(0,J.Z)(M,[["__scopeId","data-v-308827a7"]]);var Z=G,D=t(40),F=t(9053),H=t(9576),A={class:"calendar-item-dialog-header"},x=["textContent"],K=(0,r.aZ)({__name:"CalendarItemDialog",props:{value:null},emits:["update:value","record-updated"],setup:function(e,n){var t=this,c=n.emit,d=e,v=(0,i.iH)(""),m=(0,i.iH)(),w=(0,i.iH)(),g=(0,r.Fl)((function(){return d.value.calendarItem.weight})),p=(0,r.Fl)((function(){return d.value.calendarItem.dateTime.setLocale("en-GB").toLocaleString(f.ou.DATE_FULL)})),y=function(){(0,r.Y3)((function(){var e;null===(e=m.value)||void 0===e||e.focusAtEnd()}))},T=(0,r.Fl)((function(){return{show:d.value.show,onFadeInStart:function(){y()}}})),_={event:"input",validateFunction:function(e){var n=0===e.length;if(n)return{isValid:!0,errorMessage:""};var t=!/^\d+(.\d+)*$/.test(e);return t?{isValid:!1,errorMessage:"Please input numbers only"}:{isValid:!0,errorMessage:""}}},S=function(e){c("update:value",(0,a.pi)((0,a.pi)({},d.value),e))},k=function(e){S({show:e.show})},I=function(e){S({calendarItem:(0,a.pi)((0,a.pi)({},d.value.calendarItem),{weight:e})})},b=function(){v.value=d.value.calendarItem.weight},C=function(){S({show:!1})},U=function(){var e,n=[null===(e=m.value)||void 0===e?void 0:e.validateInput()];return!n.some((function(e){return!1===e}))},M=function(){return(0,a.mG)(t,void 0,void 0,(function(){var e,n,t;return(0,a.Jh)(this,(function(r){switch(r.label){case 0:return v.value===d.value.calendarItem.weight?[2]:(e=U(),e?[4,(0,l.C)((function(){return(0,s.S)(d.value.calendarItem.dateTime,{date:d.value.calendarItem.dateTime.toISODate(),weight:Number(d.value.calendarItem.weight)})}))]:[2]);case 1:return n=r.sent(),n.error?(t=(0,h.pm)(),t.error(n.error.message),[2]):(c("record-updated",{isTargetMonth:d.value.calendarItem.isTargetMonth}),[2])}}))}))},J=function(){var e;null===(e=w.value)||void 0===e||e.handleBackgroundMaskClick()};return function(e,n){return(0,r.wg)(),(0,r.j4)(D.Z,{ref_key:"customDialogRef",ref:w,value:(0,i.SU)(T),"onUpdate:value":k,onKeydown:(0,u.D2)(J,["enter"])},{default:(0,r.w5)((function(){return[((0,r.wg)(),(0,r.iD)("div",{key:"calendar-item-dialog".concat(d.value.show),class:"calendar-item-dialog"},[(0,r._)("header",A,[(0,r._)("span",{class:"title",textContent:(0,o.zw)((0,i.SU)(p))},null,8,x),(0,r.Wm)(H.Z,{class:"close-button",onClick:C,onKeydown:C})]),(0,r.Wm)(F.Z,{ref_key:"weightInputRef",ref:m,"input-text":(0,i.SU)(g),class:"weight-input","validate-config":_,placeholder:"Weight","onUpdate:inputText":I,onFocus:b,onBlur:M},null,8,["input-text"])]))]})),_:1},8,["value","onKeydown"])}}});const P=(0,J.Z)(K,[["__scopeId","data-v-9f428f46"]]);var W=P,L={class:"custom-calendar"},R={class:"calendar-main"},z={class:"weekday"},E=["onClick","onKeydown"],j={class:"day"},N={class:"weight-wrapper"},O={class:"weight"},Y={key:0,class:"unit"},B=(0,r.aZ)({__name:"CustomCalendar",setup:function(e){var n=this,t=.5,m=(0,c.Z)(),w=(0,r.Fl)((function(){return m.isMobile})),g=(0,i.iH)(),p=(0,i.iH)(),y=(0,i.qj)({dateTime:f.ou.now().setLocale("en-GB").set({hour:0,minute:0,second:0,millisecond:0})}),T=(0,i.iH)(!0),_=(0,i.qj)({value:{show:!1,calendarItem:{dateTime:f.ou.now(),day:f.ou.now().day,isTargetMonth:!1,weekdayShort:f.ou.now().weekdayShort,weight:"",isToday:!0}}}),S=(0,i.iH)({}),k=function(){return(0,a.mG)(n,void 0,void 0,(function(){var e,n,t;return(0,a.Jh)(this,(function(r){switch(r.label){case 0:return[4,(0,l.C)((function(){return(0,s.$)(y.dateTime)}))];case 1:return e=r.sent(),e.error?(n=(0,h.pm)(),n.error(e.error.message),[2]):(t=e.data,S.value=t,[2])}}))}))},I=function(e){return(0,a.mG)(n,void 0,void 0,(function(){var n,t,r,i,o;return(0,a.Jh)(this,(function(u){switch(u.label){case 0:return[4,(0,l.C)((function(){return(0,s.$)(e.dateTime)}))];case 1:return n=u.sent(),n.error?(t=(0,h.pm)(),t.error(n.error.message),[2]):(r=n.data,_.value.calendarItem=(0,a.pi)((0,a.pi)({},e),{weight:null!==(o=null===(i=r[e.day])||void 0===i?void 0:i.weight.toString())&&void 0!==o?o:""}),_.value.show=!0,[2])}}))}))},b=function(e){var n,t;return null!==(t=null===(n=S.value[e])||void 0===n?void 0:n.weight.toString())&&void 0!==t?t:""},C=function(e){var n=e.set({day:1});return n},U=function(e){var n=e.set({day:e.daysInMonth});return n},M=function(e){for(var n=C(e),t=[],r=f.ou.now(),a=0;a<Number(e.daysInMonth);a+=1){var i=n.plus({day:a}),o=i.hasSame(r,"day"),u={weekdayShort:i.weekdayShort,day:i.day,dateTime:i,isTargetMonth:!0,weight:b(i.day),isToday:o};t.push(u)}return t},J=function(e){for(var n=C(e),t=Number(n.weekday),r=t,a=[],i=1;i<=r;i+=1){var o=n.minus({day:i}),u={weekdayShort:o.weekdayShort,day:o.day,dateTime:o,isTargetMonth:!1,weight:"",isToday:!1};a.unshift(u)}return a},G=function(e){for(var n=U(e),t=Number(n.weekday),r=Math.abs(t%7-6),a=[],i=1;i<=r;i+=1){var o=n.plus({day:i}),u={weekdayShort:o.weekdayShort,day:o.day,dateTime:o,isTargetMonth:!1,weight:"",isToday:!1};a.push(u)}return a},D=function(e){var n=M(e),t=J(e),r=G(e);return(0,a.ev)((0,a.ev)((0,a.ev)([],t,!0),n,!0),r,!0)},F=function(e,n){var t="weekdayShort",r=e.set({weekday:n})[t].toString();return r},H=(0,r.Fl)((function(){for(var e=y.dateTime,n=[F(e,7)],t=1;t<=6;t+=1){var r=F(e,t);n.push(r)}return n})),A=(0,r.Fl)((function(){return D(y.dateTime)})),x=function(){if(null!=p.value){var e=d.ZP.timeline();e.from(p.value,{autoAlpha:0,ease:v.Au.easeInOut,stagger:{amount:1,from:"start"}},0).duration(1)}else console.error("Header items not found")},K=function(){return new Promise((function(e,n){if(null!=g.value){var r=d.ZP.timeline();r.set(g.value,{autoAlpha:0,scale:.75}),r.to(g.value,{autoAlpha:1,stagger:{amount:t,from:"start",grid:"auto",ease:v.bJ.easeInOut},scale:1,onComplete:function(){e(!0)}}).duration(t)}else n(Error("Cannot find elements to animation"))}))},P=function(){return new Promise((function(e,n){if(null!=g.value){var r=d.ZP.timeline();r.set(g.value,{autoAlpha:1,scale:1}),r.to(g.value,{autoAlpha:0,stagger:{amount:t,from:"end",grid:"auto",ease:v.bJ.easeInOut},scale:.75,onComplete:function(){e(!0)}}).duration(t)}else n(Error("Cannot find elements to animation"))}))};(0,r.YP)((function(){return y.dateTime}),(function(){return(0,a.mG)(n,void 0,void 0,(function(){var e=this;return(0,a.Jh)(this,(function(n){return(0,r.Y3)((function(){return(0,a.mG)(e,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return[4,k()];case 1:return e.sent(),[4,K()];case 2:return e.sent(),T.value=!0,[2]}}))}))})),[2]}))}))}));var B=function(){return(0,a.mG)(n,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return T.value?(T.value=!1,[4,P()]):[2];case 1:return e.sent(),y.dateTime=y.dateTime.minus({month:1}),[2]}}))}))},V=function(){return(0,a.mG)(n,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return T.value?(T.value=!1,[4,P()]):[2];case 1:return e.sent(),y.dateTime=y.dateTime.plus({month:1}),[2]}}))}))},$=function(e){return(0,a.mG)(n,void 0,void 0,(function(){return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return e.isTargetMonth?[4,I(e)]:[2];case 1:return n.sent(),[2]}}))}))},q=function(){return(0,a.mG)(n,void 0,void 0,(function(){var e,n;return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return e=f.ou.now(),n={dateTime:e,day:e.day,isTargetMonth:e.hasSame(y.dateTime,"month"),isToday:!0,weekdayShort:e.weekdayShort,weight:""},[4,I(n)];case 1:return t.sent(),[2]}}))}))},Q=function(e){return(0,a.mG)(n,void 0,void 0,(function(){return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return e.isTargetMonth?[4,k()]:[2];case 1:return n.sent(),[2]}}))}))};return(0,r.bv)((function(){return(0,a.mG)(n,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return x(),[4,k()];case 1:return e.sent(),[4,K()];case 2:return e.sent(),[2]}}))}))})),function(e,n){return(0,r.wg)(),(0,r.iD)("div",L,[(0,r.Wm)(Z,{"date-time":y.dateTime,onPreviousMonth:B,onNextMonth:V,onAdd:q},null,8,["date-time"]),(0,r._)("div",R,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,i.SU)(H),(function(e,n){return(0,r.wg)(),(0,r.iD)("div",{key:n,ref_for:!0,ref_key:"headerItemRefList",ref:p,class:(0,o.C_)(["calendar-item header-item"])},[(0,r._)("span",z,(0,o.zw)(e),1)])})),128)),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,i.SU)(A),(function(e,n){return(0,r.wg)(),(0,r.iD)("div",{key:n,ref_for:!0,ref_key:"dayItemRefList",ref:g,class:(0,o.C_)(["calendar-item day-item",!e.isTargetMonth&&"not-target",e.isToday&&"today"]),onClick:function(n){return $(e)},onKeydown:function(n){return $(e)}},[(0,r._)("span",j,(0,o.zw)(e.day),1),(0,r.wy)((0,r._)("div",N,[(0,r._)("span",O,(0,o.zw)(e.weight),1),(0,i.SU)(w)?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("span",Y,"KG"))],512),[[u.F8,""!=e.weight]])],42,E)})),128))]),(0,r.Wm)(W,{value:_.value,"onUpdate:value":n[0]||(n[0]=function(e){return _.value=e}),onRecordUpdated:Q},null,8,["value"])])}}});const V=(0,J.Z)(B,[["__scopeId","data-v-47078da8"]]);var $=V,q={class:"record-view"},Q=(0,r.aZ)({__name:"RecordsView",setup:function(e){return function(e,n){return(0,r.wg)(),(0,r.iD)("div",q,[(0,r.Wm)($)])}}});const X=(0,J.Z)(Q,[["__scopeId","data-v-2c4443d6"]]);var ee=X}}]);
//# sourceMappingURL=458.51ac115d.js.map